-- Criação da sequence para perfis
CREATE SEQUENCE SGI_PERFIL_SEQ
    START WITH 1
    INCREMENT BY 1
    NOCACHE
    NOCYCLE;

-- Criação da tabela de perfis
CREATE TABLE SGI_PERFIL (
    PER_ID NUMBER DEFAULT SGI_PERFIL_SEQ.NEXTVAL,
    PER_NOME VARCHAR2(50) NOT NULL,
    PER_DESCRICAO VARCHAR2(255),
    CONSTRAINT PK_SGI_PERFIL PRIMARY KEY (PER_ID),
    CONSTRAINT UK_SGI_PERFIL_NOME UNIQUE (PER_NOME)
);

-- Inserir perfis padrão
INSERT INTO SGI_PERFIL (PER_NOME, PER_DESCRICAO) VALUES ('USER', 'Usuário padrão');
INSERT INTO SGI_PERFIL (PER_NOME, PER_DESCRICAO) VALUES ('ADMIN', 'Administrador');
INSERT INTO SGI_PERFIL (PER_NOME, PER_DESCRICAO) VALUES ('GESTOR', 'Gestor do sistema');

-- Criação da tabela de usuários
CREATE TABLE SGI_USUARIOS (
    USU_ID NUMBER GENERATED BY DEFAULT AS IDENTITY START WITH 1 INCREMENT BY 1,
    USU_CPF VARCHAR2(20) NOT NULL,
    USU_NOME VARCHAR2(255) NOT NULL,
    USU_EMAIL VARCHAR2(255) NOT NULL,
    USU_SENHA VARCHAR2(255) NOT NULL,
    USU_STATUS NUMBER(1) DEFAULT 1 NOT NULL,
    PERFIL_ID NUMBER,
    CONSTRAINT PK_SGI_USUARIOS PRIMARY KEY (USU_ID),
    CONSTRAINT UK_SGI_USUARIOS_CPF UNIQUE (USU_CPF),
    CONSTRAINT UK_SGI_USUARIOS_EMAIL UNIQUE (USU_EMAIL),
    CONSTRAINT FK_SGI_USUARIOS_PERFIL FOREIGN KEY (PERFIL_ID) REFERENCES SGI_PERFIL(PER_ID)
);
